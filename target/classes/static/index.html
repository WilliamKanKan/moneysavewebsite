<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="css/css" rel="stylesheet">
  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/all.css">
  <title>登录/注册</title>
  <style>
    .half {
      position: relative;
      transition: transform 0.5s ease;
    }

    .slide-left {
      transform: translateX(-50%);
    }

    .slide-right {
      transform: translateX(0);
    }

    .register-form {
      display: none;
    }

    .success-form {
      display: none;
    }

    .half.slide-left {
      transform: translateX(-50%);
    }

    .half.register {
      display: none;
    }
  </style>
</head>

<body>
<div class="d-lg-flex half">
  <div class="bg order-1 order-md-2" style="background-image: url('images/bg_1.jpg');"></div>
  <div class="contents order-2 order-md-1">
    <div class="container">
      <div class="row align-items-center justify-content-center">
        <div class="col-md-7 login-form">
          <div class="mb-4">
            <h3>Sign In</h3>
            <p class="mb-4">Lorem ipsum dolor sit amet elit. Sapiente sit aut eos consectetur adipisicing.</p>
          </div>
          <form>
            <div class="form-group first">
              <label for="login-username">Username</label>
              <input type="text" class="form-control" id="login-username">
            </div>
            <div class="form-group last mb-3">
              <label for="login-password">Password</label>
              <input type="password" class="form-control" id="login-password">
            </div>
            <div class="d-flex mb-5 align-items-center">
              <label class="control control--checkbox mb-0">
                <span class="caption">Remember me</span>
                <input type="checkbox" checked="checked">
                <div class="control__indicator"></div>
              </label>
              <span class="ml-auto"><a href="#" class="forgot-pass">Forgot Password</a></span>
            </div>
            <input type="submit" value="登录" class="btn btn-block btn-primary" id="loginBtn">
            <span class="d-block text-center my-4 text-muted">— or —</span>
            <div class="social-login">
              <a href="#" class="facebook btn d-flex justify-content-center align-items-center">
                <span class="icon-facebook mr-3"></span> Login with Facebook
              </a>
              <a href="#" class="twitter btn d-flex justify-content-center align-items-center">
                <span class="icon-twitter mr-3"></span> Login with Twitter
              </a>
              <a href="#" class="google btn d-flex justify-content-center align-items-center">
                <span class="icon-google mr-3"></span> Login with Google
              </a>
            </div>
            <p class="text-center mt-4">Don't have an account? <a href="#" id="switchToRegister">Sign Up</a></p>
          </form>
        </div>
        <div class="col-md-5 register-form">
          <div class="mb-4">
            <h3>Sign Up</h3>
            <p class="mb-4">Create a new account.</p>
          </div>
          <form>
            <div class="form-group first">
              <label for="register-username">Username</label>
              <input type="text" class="form-control" id="register-username">
            </div>
            <div class="form-group">
              <label for="register-email">Email</label>
              <input type="email" class="form-control" id="register-email">
            </div>
            <div class="form-group">
              <label for="register-password">Password</label>
              <input type="password" class="form-control" id="register-password">
            </div>
            <div class="form-group last mb-3">
              <label for="register-confirm-password">Confirm Password</label>
              <input type="password" class="form-control" id="register-confirm-password">
            </div>
            <input type="submit" value="注册" class="btn btn-block btn-primary" id="registerBtn">
            <p class="text-center mt-4">Already have an account? <a href="#" id="switchToLogin">Sign In</a></p>
          </form>
        </div>
        <div class="col-md-5 success-form">
          <div class="mb-4">
            <h1>登录成功</h1>
            <p class="mb-4"></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/main.js"></script>
<script>
  function submitLoginForm() {
    var username = document.getElementById('login-username').value;
    var password = document.getElementById('login-password').value;

    $.ajax({
      url: '/loginIn',
      type: 'POST',
      data: {
        username: username,
        password: password
      },
      success: function (response) {
        if (response === 'success') {
          switchToSuccess();
        } else {
          alert('登录失败，请检查用户名和密码');
        }
      },
      error: function () {
        alert('请求失败，请稍后重试');
      }
    });
  }

  function submitSignupForm() {
    var username = document.getElementById('register-username').value;
    var email = document.getElementById('register-email').value;
    var password = document.getElementById('register-password').value;
    var confirmPassword = document.getElementById('register-confirm-password').value;

    $.ajax({
      url: '/register',
      type: 'POST',
      data: JSON.stringify({
        username: username,
        email: email,
        password: password,
        confirmPassword: confirmPassword
      }),
      contentType: 'application/json',
      success: function (response) {
        if (response === 'success') {
          $('.login-form').slideDown(300);
          $('.register-form').slideUp(1);
        } else if (response === 'fail') {
          alert('两次密码不一致');
        }
        else {
          alert('注册失败，请稍后重试');
        }
      },
      error: function () {
        alert('请求失败，请稍后重试');
      }
    });
  }

  function switchToSuccess() {
    $('.login-form').slideUp(300, function () {
      $('.success-form').slideDown(300);
    });
  }

  $(document).ready(function () {
    $('#switchToRegister').click(function (e) {
      e.preventDefault();
      $('.login-form').slideUp(300, function () {
        $('.register-form').slideDown(300);
      });
    });

    $('#switchToLogin').click(function (e) {
      e.preventDefault();
      $('.register-form').slideUp(300, function () {
        $('.login-form').slideDown(300);
      });
    });

    $('#loginBtn').click(function (e) {
      e.preventDefault();
      submitLoginForm();
    });

    $('#registerBtn').click(function (e) {
      e.preventDefault();
      submitSignupForm();
    });
  });
</script>
</body>

</html>
